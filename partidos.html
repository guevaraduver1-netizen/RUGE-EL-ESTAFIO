<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RUGE EL ESTADIO - Partidos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style id="dynamic-theme">
        /* --- MOTOR DE FUENTES RUGE EL ESTADIO --- */
        @font-face { font-family: 'Jersey'; src: url('assets/fonts/Jersey.ttf'); }
        @font-face { font-family: 'Bangers'; src: url('assets/fonts/Bangers.ttf'); }
        @font-face { font-family: 'Smooch'; src: url('assets/fonts/SmoochSans-Bold.ttf'); }
        @font-face { font-family: 'Afacad'; src: url('assets/fonts/Afacad-Bold.ttf'); }
        @font-face { font-family: 'Permanent Marker'; src: url('assets/fonts/PermanentMarker.ttf'); }
        @font-face { font-family: 'Gloria'; src: url('assets/fonts/Gloria.ttf'); }
        @font-face { font-family: 'Goldman'; src: url('assets/fonts/Goldman-Bold.ttf'); }
        @font-face { font-family: 'Gruppo'; src: url('assets/fonts/Gruppo.ttf'); }
        @font-face { font-family: 'Josefin Slab'; src: url('assets/fonts/JosefinSlab-Bold.ttf'); }
        @font-face { font-family: 'Bahianita'; src: url('assets/fonts/Bahianita.ttf'); }
        @font-face { font-family: 'Caveat'; src: url('assets/fonts/Caveat-Bold.ttf'); }
        @font-face { font-family: 'Rubik Iso'; src: url('assets/fonts/RubikIso.ttf'); }
        @font-face { font-family: 'Tagesschrift'; src: url('assets/fonts/Tagesschrift.ttf'); }

        :root { 
            --neon: #2ecc71; 
            --border: rgba(46, 204, 113, 0.2); 
            --glass: rgba(255, 255, 255, 0.05); 
            --fuente-principal: 'Afacad', sans-serif;
        }
    </style>

    <style>
        body { 
            margin: 0; padding: 0; 
            font-family: var(--fuente-principal); 
            background: #000; color: white; overflow-x: hidden; text-align: center; 
        }
        
        button, input, .nav-btn, .news-title, .news-tag, h3, span {
            font-family: var(--fuente-principal) !important;
        }

        .bg-blur { position: fixed; top: 0; left: 0; width: 100%; height: 100vh; z-index: -1; background-size: cover; background-position: center; transition: 0.5s; background-attachment: fixed; }
        .header { position: fixed; top: 0; width: 100%; height: 60px; display: flex; align-items: center; justify-content: center; background: rgba(0, 0, 0, 0.95); border-bottom: 2px solid var(--neon); z-index: 2000; backdrop-filter: blur(10px); }
        .back-btn { position: absolute; left: 10px; color: var(--neon); font-size: 24px; background: transparent; border: none; cursor: pointer; }
        
        .nav-scroll { position: fixed; top: 60px; width: 100%; z-index: 1900; display: flex; justify-content: flex-start; overflow-x: auto; padding: 12px; gap: 8px; background: rgba(0,0,0,0.85); border-bottom: 1px solid var(--border); white-space: nowrap; }
        .nav-scroll::-webkit-scrollbar { display: none; }

        .nav-btn { padding: 8px 18px; background: var(--glass); border: 1px solid var(--border); border-radius: 20px; font-size: 10px; color: #fff; text-transform: uppercase; font-weight: 900; cursor: pointer; transition: 0.3s; }
        .nav-btn.active { background: var(--neon); color: #000; border-color: var(--neon); box-shadow: 0 0 10px var(--neon); }
        .container { padding: 140px 15px 120px; display: flex; flex-direction: column; align-items: center; gap: 20px; min-height: 100vh; }

        /* --- ESTILOS LIVE --- */
        .live-card { width: 100%; max-width: 400px; background: rgba(0,0,0,0.6); border: 1px solid var(--border); border-radius: 15px; padding: 20px; margin-bottom: 15px; position: relative; overflow: hidden; transition: 0.3s; order: 2; cursor: pointer; }
        .live-card:active { transform: scale(0.98); background: rgba(255,255,255,0.1); }
        .live-card.active-match { border-color: var(--neon); box-shadow: 0 0 15px var(--border); order: 1; }
        .live-badge { position: absolute; top: 10px; right: 10px; background: #ff0000; color: white; font-size: 8px; padding: 2px 8px; border-radius: 10px; font-weight: 900; animation: blink 1s infinite; }
        .live-match-info { display: flex; justify-content: space-between; align-items: center; gap: 10px; margin: 10px 0; }
        .team-name { font-size: 13px; font-weight: 900; flex: 1; text-transform: uppercase; color: #fff; }
        .match-score { font-size: 24px; font-weight: 900; color: var(--neon); letter-spacing: 5px; min-width: 80px; }
        .match-timer { font-size: 11px; color: var(--neon); font-weight: bold; opacity: 0.8; }
        .match-league { font-size: 9px; color: #888; text-transform: uppercase; display: block; }
        .ver-detalle { font-size: 8px; color: var(--neon); margin-top: 10px; display: block; text-transform: uppercase; letter-spacing: 1px; font-weight: bold; }

        /* Sync Button */
        .api-connect-btn { width: 100%; max-width: 400px; padding: 15px; background: rgba(0,0,0,0.6); border: 2px solid var(--neon); border-radius: 12px; color: var(--neon); font-weight: 900; font-size: 11px; letter-spacing: 2px; cursor: pointer; margin-bottom: 10px; position: relative; }
        .api-status-dot { height: 8px; width: 8px; background: #555; border-radius: 50%; display: inline-block; margin-right: 10px; }
        .dot-active { background: var(--neon) !important; animation: blink 1s infinite; }
        .mode-label { position: absolute; bottom: -18px; left: 50%; transform: translateX(-50%); font-size: 8px; color: #888; letter-spacing: 1px; }

        /* News Cards */
        .news-card { background: var(--glass); border: 1px solid var(--border); border-radius: 20px; overflow: hidden; width: 100%; max-width: 400px; animation: fadeIn 0.5s ease; cursor: pointer; margin-bottom: 15px; display: flex; flex-direction: column; backdrop-filter: blur(5px); transition: 0.3s; }
        .news-card:active { transform: scale(0.98); }
        .img-container { width: 100%; height: 180px; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; border-bottom: 1px solid var(--border); overflow: hidden; }
        .news-img { width: 100%; height: 100%; object-fit: cover; }
        .news-img.backup-mode { width: 60%; height: 60%; object-fit: contain; filter: drop-shadow(0 0 5px var(--neon)); }
        .news-info { padding: 20px; text-align: center; }
        .news-tag { color: var(--neon); font-size: 10px; font-weight: bold; text-transform: uppercase; }
        .news-title { font-size: 14px; font-weight: bold; margin-top: 8px; line-height: 1.4; color: #fff; }

        /* --- RADIO PLAYER --- */
        #radio-player { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.95); border-top: 2px solid var(--neon); padding: 15px; display: none; align-items: center; justify-content: space-around; z-index: 3000; backdrop-filter: blur(15px); animation: slideUp 0.3s ease; }
        .radio-info { display: flex; align-items: center; gap: 12px; flex: 1; text-align: left; }
        .radio-logo-mini { width: 40px; height: 40px; border-radius: 50%; border: 1px solid var(--neon); object-fit: cover; }
        .radio-text-container { display: flex; flex-direction: column; }
        .radio-now-playing { font-size: 12px; font-weight: 900; color: #fff; text-transform: uppercase; }
        .radio-status { font-size: 9px; color: var(--neon); font-weight: bold; letter-spacing: 1px; }
        .radio-controls { display: flex; align-items: center; gap: 20px; }
        .radio-btn { background: none; border: none; color: white; font-size: 24px; cursor: pointer; transition: 0.2s; }
        .radio-btn:active { transform: scale(0.9); color: var(--neon); }

        @keyframes blink { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    </style>
</head>
<body>
    <div class="bg-blur" id="bg-main"></div>
    <header class="header">
        <button class="back-btn" onclick="window.history.back();"><i class="fa-solid fa-chevron-left"></i></button>
        <h3 style="margin:0; letter-spacing: 5px; font-size: 14px; font-weight: 900;" data-key="header_title">PARTIDOS RUGE</h3>
    </header>

    <nav class="nav-scroll">
        <div class="nav-btn active" id="btn-min" onclick="cambiarSeccion('minuto')" data-key="btn_min">MINUTO A MINUTO</div>
        <div class="nav-btn" id="btn-col" onclick="cambiarSeccion('colombia')" data-key="btn_col">COLOMBIA</div>
        <div class="nav-btn" id="btn-rad" onclick="cambiarSeccion('radio')" data-key="btn_rad">RADIO RUGE</div>
        <div class="nav-btn" id="btn-lat" onclick="cambiarSeccion('latam')" data-key="btn_lat">LATAM</div>
        <div class="nav-btn" id="btn-eur" onclick="cambiarSeccion('europa')" data-key="btn_eur">EUROPA</div>
    </nav>

    <div class="container">
           <button class="api-connect-btn" id="btn-sync-main" onclick="alternarModoConexion()">
            <span class="api-status-dot" id="dot"></span>
            <span id="api-text" data-key="api_force">SINCRO AUTOMÁTICA</span>
            <span class="mode-label" id="mode-label" data-key="mode_label_auto">CLICK PARA CAMBIAR A RESPALDO</span>
        </button>
        <div id="news-grid" style="width:100%; display:flex; flex-direction:column; align-items:center;"></div>
    </div>
<div id="radio-player">
        <div class="radio-info">
            <img id="radio-img" src="" class="radio-logo-mini">
            <div class="radio-text-container">
                <span id="radio-name" class="radio-now-playing">ESTACIÓN</span>
                <span id="radio-load-status" class="radio-status"><i class="fa-solid fa-signal"></i> LIVE SIGNAL</span>
            </div>
        </div>
        <div class="radio-controls">
            <button class="radio-btn" onclick="toggleRadio()"><i id="radio-icon" class="fa-solid fa-play"></i></button>
            <button class="radio-btn" onclick="closeRadio()" style="font-size: 18px; opacity: 0.5;"><i class="fa-solid fa-xmark"></i></button>
        </div>
    </div>

    <script>
        const API_KEY_YT = 'AIzaSyDlQ8dCzN8PLZxYi5hS36Vw3zqOTEnmmQQ';
        const API_KEY_ALLSPORTS = '70183699b2377c17cfc4aa22c9b836e735c656cb36aa29e18827edd463bbdbe8';

        let seccionActual = 'minuto';
        let modoRespaldo = false;
        let socketConnection = null;
        let userLang = localStorage.getItem('userLang') || 'es';
        
        // --- MOTOR DE AUDIO MOLDE BLINDADO ---
        let radioAudio = new Audio();
        radioAudio.crossOrigin = "anonymous";
        let radioActiva = false;

        const dictionary = {
            es: {
                header_title: "PARTIDOS RUGE", btn_min: "MINUTO A MINUTO", btn_col: "COLOMBIA", btn_rad: "RADIO RUGE", btn_lat: "LATAM", btn_eur: "EUROPA",
                api_force: "SINCRO AUTOMÁTICA", api_backup: "MODO RESPALDO ACTIVO", api_live_only: "SATÉLITE EN VIVO OBLIGATORIO",
                tag_backup: "CANAL OFICIAL", access_to: "VER CONTENIDO DE:", live_waiting: "CARGANDO CARTELERA DEL DÍA...",
                view_details: "Sincronizar detalle en vivo", mode_label_auto: "CLICK PARA CAMBIAR A RESPALDO",
                mode_label_backup: "CLICK PARA VOLVER A AUTOMÁTICO", satellite_active: "SATÉLITE RUGE ACTIVO",
                tag_radio: "RADIO EN VIVO", listen_now: "SINTONIZAR AHORA", radio_error: "ERROR: USA WEB OFICIAL"
            },
            en: {
                header_title: "ROAR MATCHES", btn_min: "MINUTE BY MINUTE", btn_col: "COLOMBIA", btn_rad: "ROAR RADIO", btn_lat: "LATAM", btn_eur: "EUROPE",
                api_force: "AUTO SYNC", api_backup: "BACKUP MODE", api_live_only: "LIVE SATELLITE REQUIRED",
                tag_backup: "OFFICIAL CHANNEL", access_to: "GO TO:", live_waiting: "LOADING MATCH DAY...",
                view_details: "Sync live details", mode_label_auto: "CLICK TO SWITCH TO BACKUP",
                mode_label_backup: "CLICK TO RETURN TO AUTO", satellite_active: "ROAR SATELLITE ACTIVE",
                tag_radio: "LIVE RADIO", listen_now: "TUNE IN NOW", radio_error: "ERROR: USE OFFICIAL WEB"
            }
        };

        const SECCIONES = {
            colombia: [
                { nombre: "NOTICIAS RCN", id: "UCOqPtiqIO3XobOq3txjwdZA", url: "https://www.youtube.com/@DeportesRCN/videos", logo: "assets/imagen/logos/rcn.png" },
                { nombre: "WIN SPORTS", id: "UCfO-YJmO6lS6m6H9-24pX7w", url: "https://www.youtube.com/@WinSportsTV/videos", logo: "assets/imagen/logos/win.jpg" }
            ],
            radio: [
                { nombre: "BLU RADIO", stream: "https://streaming.caracol.com.co/as_blu_radio.mp3", url: "https://www.bluradio.com/al-aire", logo: "assets/imagen/logos/blu.png" },
                { nombre: "CARACOL RADIO", stream: "https://streaming.caracol.com.co/as_caracol_radio.mp3", url: "https://caracol.com.co/emisora/", logo: "assets/imagen/logos/caracol.jpg" },
                { nombre: "ANTENA 2", stream: "https://27153.live.streamtheworld.com/ANTENA_2_COLOMBIA.mp3", url: "https://www.antena2.com/escuchar-en-vivo", logo: "assets/imagen/logos/antena2.png" },
                { nombre: "W RADIO", stream: "https://streaming.caracol.com.co/as_w_radio.mp3", url: "https://www.wradio.com.co/escucha-en-vivo/", logo: "assets/imagen/logos/wradio.png" },
            { nombre: "RCN RADIO", stream: "https://share.google/8rxtD8D5mCzj8qeKb", url: "https://share.google/8rxtD8D5mCzj8qeKb", logo: "assets/imagen/logos/rcnr.png" }
       
            ],
            
            latam: [
                { nombre: "ESPN FANS", id: "UCXF_1mSAn_L89D-iC_oN6-w", url: "https://www.youtube.com/@espnfans/videos", logo: "assets/imagen/logos/espn.png" },
                { nombre: "CÁBALA FUTBOLERA", id: "UC35H6o0I2z6T5qYh5p7_q_g", url: "https://www.youtube.com/@cabalafutbolera/videos", logo: "assets/imagen/logos/Cf.jpg" }
            ],
            europa: [
                { nombre: "DIARIO AS", id: "UCvG8I_w9fJ0vF_mB08j-IBA", url: "https://www.youtube.com/@diarioas/videos", logo: "assets/imagen/logos/as.png" },
                { nombre: "MARCA", id: "UCp_8idv_u2mBv0V_lH3_e-A", url: "https://www.youtube.com/@marca/videos", logo: "assets/imagen/logos/marca.png" }
            ]
        };

        // --- SISTEMA DE RADIO REFORZADO ---
        function sintonizarRadio(nombre, stream, logo, fallbackUrl) {
            document.getElementById('radio-player').style.display = 'flex';
            document.getElementById('radio-name').innerText = nombre;
            document.getElementById('radio-img').src = logo;
            document.getElementById('radio-load-status').innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> CONECTANDO...';
            
            radioAudio.pause();
            radioAudio.src = stream;
            radioAudio.load();
            
            let playPromise = radioAudio.play();

            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    radioActiva = true;
                    document.getElementById('radio-icon').className = 'fa-solid fa-pause';
                    document.getElementById('radio-load-status').innerHTML = '<i class="fa-solid fa-signal"></i> LIVE SIGNAL';
                }).catch(error => {
                    // Si el navegador bloquea el stream directo (CORS/Mixed Content)
                    document.getElementById('radio-load-status').innerText = dictionary[userLang].radio_error;
                    setTimeout(() => { window.open(fallbackUrl, '_blank'); }, 1500);
                });
            }
        }

        function toggleRadio() {
            if(!radioAudio.paused) {
                radioAudio.pause();
                document.getElementById('radio-icon').className = 'fa-solid fa-play';
            } else {
                radioAudio.play();
                document.getElementById('radio-icon').className = 'fa-solid fa-pause';
            }
        }

        function closeRadio() {
            radioAudio.pause();
            radioAudio.src = "";
            document.getElementById('radio-player').style.display = 'none';
        }

        function updateLanguage() {
            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.getAttribute('data-key');
                if (dictionary[userLang][key]) el.innerText = dictionary[userLang][key];
            });
            actualizarInterfazSync();
        }

        function verDetallePartido(home, away) {
            const query = encodeURIComponent(`${home} vs ${away} marcador en vivo`);
            window.location.href = `https://www.google.com/search?q=${query}`;
        }

        function alternarModoConexion() {
            if(seccionActual === 'minuto' || seccionActual === 'radio') return;
            modoRespaldo = !modoRespaldo;
            actualizarInterfazSync();
            activarYConsultar();
        }

        function actualizarInterfazSync() {
            const btnText = document.getElementById('api-text');
            const label = document.getElementById('mode-label');
            const dot = document.getElementById('dot');
            const btn = document.getElementById('btn-sync-main');

            if(seccionActual === 'minuto' || seccionActual === 'radio') {
                btnText.innerText = dictionary[userLang].satellite_active;
                label.innerText = dictionary[userLang].api_live_only;
                dot.classList.add('dot-active');
                btn.style.opacity = "0.7";
                btn.style.cursor = "default";
                return;
            }

            btn.style.opacity = "1";
            btn.style.cursor = "pointer";
            if(modoRespaldo) {
                btnText.innerText = dictionary[userLang].api_backup;
                label.innerText = dictionary[userLang].mode_label_backup;
                dot.classList.remove('dot-active');
            } else {
                btnText.innerText = dictionary[userLang].api_force;
                label.innerText = dictionary[userLang].mode_label_auto;
            }
        }

        async function activarYConsultar() {
            const grid = document.getElementById('news-grid');
            const dot = document.getElementById('dot');
            actualizarInterfazSync();
            
            if(seccionActual === 'minuto') { await cargarCarteleraLive(); return; }

            if(seccionActual === 'radio') {
                grid.innerHTML = SECCIONES.radio.map(estacion => `
                    <div class="news-card" onclick="sintonizarRadio('${estacion.nombre}', '${estacion.stream}', '${estacion.logo}', '${estacion.url}')">
                        <div class="img-container"><img src="${estacion.logo}" class="news-img backup-mode"></div>
                        <div class="news-info">
                            <span class="news-tag">${dictionary[userLang].tag_radio}</span>
                            <div class="news-title">${dictionary[userLang].listen_now}: ${estacion.nombre}</div>
                        </div>
                    </div>`).join('');
                return;
            }

            if(modoRespaldo) {
                grid.innerHTML = SECCIONES[seccionActual].map(canal => `
                    <div class="news-card" onclick="window.location.href='${canal.url}'">
                        <div class="img-container"><img src="${canal.logo}" class="news-img backup-mode"></div>
                        <div class="news-info">
                            <span class="news-tag">${dictionary[userLang].tag_backup}</span>
                            <div class="news-title">${dictionary[userLang].access_to} ${canal.nombre}</div>
                        </div>
                    </div>`).join('');
                return;
            }

            dot.classList.add('dot-active');
            let htmlAPI = '';
            try {
                for (const canal of SECCIONES[seccionActual]) {
                    const resp = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${canal.id}&maxResults=2&order=date&type=video&key=${API_KEY_YT}`);
                    const data = await resp.json();
                    if (data.items) {
                        data.items.forEach(item => {
                            htmlAPI += `
                                <div class="news-card" onclick="window.location.href='https://www.youtube.com/watch?v=${item.id.videoId}'">
                                    <div class="img-container"><img src="${item.snippet.thumbnails.high.url}" class="news-img"></div>
                                    <div class="news-info">
                                        <span class="news-tag">${canal.nombre}</span>
                                        <div class="news-title">${item.snippet.title}</div>
                                    </div>
                                </div>`;
                        });
                    }
                }
                grid.innerHTML = htmlAPI || "SIN NOVEDADES RECIENTES";
            } catch (e) { grid.innerHTML = "ERROR DE CONEXIÓN API"; }
            dot.classList.remove('dot-active');
        }

        async function cargarCarteleraLive() {
            const grid = document.getElementById('news-grid');
            grid.innerHTML = `<div style="padding:20px; font-size:11px; opacity:0.6;">${dictionary[userLang].live_waiting}</div>`;
            try {
                const hoy = new Date().toISOString().split('T')[0];
                const resp = await fetch(`https://apiv2.allsportsapi.com/football/?met=Fixtures&APIkey=${API_KEY_ALLSPORTS}&from=${hoy}&to=${hoy}`);
                const data = await resp.json();
                if(data.result) {
                    grid.innerHTML = "";
                    data.result.forEach(m => {
                        const h = m.event_home_team.replace(/'/g, "");
                        const a = m.event_away_team.replace(/'/g, "");
                        grid.innerHTML += `
                            <div class="live-card ${m.event_live === '1' ? 'active-match' : ''}" onclick="verDetallePartido('${h}', '${a}')">
                                ${m.event_live === '1' ? '<div class="live-badge">LIVE</div>' : ''}
                                <span class="match-league">${m.league_name}</span>
                                <div class="live-match-info">
                                    <span class="team-name">${m.event_home_team}</span>
                                    <span class="match-score" id="score-${m.event_key}">${m.event_final_result || '0 - 0'}</span>
                                    <span class="team-name">${m.event_away_team}</span>
                                </div>
                                <div class="match-timer">${m.event_status === '' ? 'PROXIMAMENTE' : m.event_status + "'"}</div>
                                <span class="ver-detalle"><i class="fa-solid fa-satellite-dish"></i> ${dictionary[userLang].view_details}</span>
                            </div>`;
                    });
                }
            } catch (e) { grid.innerHTML = "ERROR DE SEÑAL"; }
        }

        function cambiarSeccion(sec) {
            seccionActual = sec;
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            const btnId = 'btn-' + sec.substring(0,3);
            if(document.getElementById(btnId)) document.getElementById(btnId).classList.add('active');
            activarYConsultar();
        }

        function applyTheme() {
            const color = localStorage.getItem('themeColor') || '#2ecc71';
            const bg = localStorage.getItem('themeBg') || 'assets/imagen/fondos/fondo.jpg';
            const font = localStorage.getItem('fuentePersonalizada') || 'Afacad';
            document.documentElement.style.setProperty('--neon', color);
            document.documentElement.style.setProperty('--border', color + '33');
            document.documentElement.style.setProperty('--fuente-principal', `'${font}', sans-serif`);
            if(document.getElementById('bg-main')) document.getElementById('bg-main').style.backgroundImage = `url('${bg}')`;
        }

        window.onload = () => { applyTheme(); updateLanguage(); activarYConsultar(); };
    </script>
</body>
</html>